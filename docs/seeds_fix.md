# Seeds æ–‡ä»¶ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

ä¹‹å‰çš„ `db/seeds.rb` æ–‡ä»¶å­˜åœ¨ä¸€ä¸ªä¸¥é‡é—®é¢˜ï¼š

```ruby
# æ—§ä»£ç  - æœ‰é—®é¢˜
Course.destroy_all  # âš ï¸ åˆ é™¤æ‰€æœ‰è¯¾ç¨‹
Course.create!(name: "AIè¯¾ç¨‹", annual_price: 999.00)  # ç”¨ç¡¬ç¼–ç ä»·æ ¼é‡å»º
```

**é—®é¢˜å½±å“ï¼š**
- æ¯æ¬¡è¿è¡Œ `rake db:seed` ä¼šåˆ é™¤æ‰€æœ‰è¯¾ç¨‹æ•°æ®
- ç”Ÿäº§ç¯å¢ƒä¸­æ‰‹åŠ¨ä¿®æ”¹çš„ä»·æ ¼ä¼šè¢«ç¡¬ç¼–ç çš„é»˜è®¤ä»·æ ¼è¦†ç›–
- å¦‚æœéƒ¨ç½²æµç¨‹åŒ…å« `rake db:seed`ï¼Œä¼šå¯¼è‡´ä»·æ ¼é‡ç½®

## âœ… è§£å†³æ–¹æ¡ˆ

ä¿®æ”¹åçš„ `db/seeds.rb` é‡‡ç”¨**éç ´åæ€§**æ–¹å¼ï¼š

### 1. ç¯å¢ƒæ£€æŸ¥
```ruby
# åªåœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒæ¸…ç†æ•°æ®
if Rails.env.development? || Rails.env.test?
  puts "Cleaning old data (#{Rails.env} environment)..."
  Course.destroy_all
end
```

### 2. ä½¿ç”¨ `find_or_create_by`
```ruby
# å¦‚æœè¯¾ç¨‹å·²å­˜åœ¨ï¼Œä¿ç•™ç°æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬ä»·æ ¼ï¼‰
# å¦‚æœè¯¾ç¨‹ä¸å­˜åœ¨ï¼Œç”¨é»˜è®¤å€¼åˆ›å»º
ai_course = Course.find_or_create_by!(slug: "aikecheng") do |course|
  course.name = "AIè¯¾ç¨‹"
  course.annual_price = 999.00  # ä»…åœ¨é¦–æ¬¡åˆ›å»ºæ—¶ä½¿ç”¨
  # ...
end
```

### 3. æ£€æŸ¥è¯¾ç¨‹æ˜¯å¦å·²å­˜åœ¨
```ruby
# åªåœ¨ç« èŠ‚æ²¡æœ‰è¯¾ç¨‹æ—¶åˆ›å»º
if ai_chapter1.lessons.empty?
  ai_chapter1.lessons.create!([...])
end
```

## ğŸ¯ ä¿®å¤æ•ˆæœ

ä¿®å¤åçš„è¡Œä¸ºï¼š

| ç¯å¢ƒ | è¿è¡Œ `rake db:seed` | ç»“æœ |
|------|-------------------|------|
| **å¼€å‘ç¯å¢ƒ** | âœ… | æ¸…ç†æ‰€æœ‰æ•°æ®ï¼Œé‡æ–°åˆ›å»ºï¼ˆæ–¹ä¾¿å¼€å‘ï¼‰ |
| **æµ‹è¯•ç¯å¢ƒ** | âœ… | æ¸…ç†æ‰€æœ‰æ•°æ®ï¼Œé‡æ–°åˆ›å»ºï¼ˆç¡®ä¿æµ‹è¯•éš”ç¦»ï¼‰ |
| **ç”Ÿäº§ç¯å¢ƒ** | âœ… | ä¿ç•™ç°æœ‰è¯¾ç¨‹å’Œä»·æ ¼ï¼Œåªåˆ›å»ºç¼ºå¤±çš„è¯¾ç¨‹ |

## ğŸ“ æ³¨æ„äº‹é¡¹

### ä¿®æ”¹è¯¾ç¨‹ä»·æ ¼çš„æ­£ç¡®æ–¹å¼

**ç”Ÿäº§ç¯å¢ƒï¼š**
1. é€šè¿‡ç®¡ç†åå°ä¿®æ”¹ä»·æ ¼
2. æˆ–è€…ä½¿ç”¨ Rails consoleï¼š
   ```ruby
   course = Course.find_by(slug: "aikecheng")
   course.update!(annual_price: 1999.00)
   ```

**é»˜è®¤ä»·æ ¼æ›´æ–°ï¼š**
- å¦‚æœéœ€è¦ä¿®æ”¹**æ–°è¯¾ç¨‹**çš„é»˜è®¤ä»·æ ¼ï¼Œç¼–è¾‘ `db/seeds.rb` ä¸­çš„ä»·æ ¼
- è¿™åªä¼šå½±å“**é¦–æ¬¡åˆ›å»º**çš„è¯¾ç¨‹ï¼Œä¸ä¼šè¦†ç›–å·²å­˜åœ¨çš„è¯¾ç¨‹

### éƒ¨ç½²å®‰å…¨æ€§

ç°åœ¨å³ä½¿éƒ¨ç½²æµç¨‹åŒ…å« `rake db:seed`ï¼Œä¹Ÿä¸ä¼šå½±å“ç”Ÿäº§ç¯å¢ƒçš„ä»·æ ¼æ•°æ®ï¼š
- ç”Ÿäº§ç¯å¢ƒä¸ä¼šæ‰§è¡Œ `destroy_all`
- `find_or_create_by` åªåˆ›å»ºä¸å­˜åœ¨çš„è¯¾ç¨‹
- å·²å­˜åœ¨çš„è¯¾ç¨‹æ•°æ®ï¼ˆåŒ…æ‹¬ä»·æ ¼ï¼‰å®Œå…¨ä¿ç•™

## ğŸ” éªŒè¯æ–¹æ³•

æµ‹è¯•ä¿®å¤æ˜¯å¦æœ‰æ•ˆï¼š

```bash
# 1. åœ¨å¼€å‘ç¯å¢ƒæµ‹è¯•
rails db:seed  # åº”è¯¥é‡æ–°åˆ›å»ºæ‰€æœ‰æ•°æ®

# 2. åœ¨ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ï¼ˆéœ€è¦ DATABASE_URLï¼‰
RAILS_ENV=production rails db:seed  # åº”è¯¥ä¿ç•™ç°æœ‰è¯¾ç¨‹
```

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `db/seeds.rb` - Seeds æ–‡ä»¶ï¼ˆå·²ä¿®å¤ï¼‰
- `app/models/course.rb` - è¯¾ç¨‹æ¨¡å‹
- `spec/requests/courses_spec.rb` - è¯¾ç¨‹æµ‹è¯•
